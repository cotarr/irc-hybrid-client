<!DOCTYPE html>
<html lang="en" dir="ltr">
	<head>
		<meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">

		<title>IRC Config</title>
    <link rel="stylesheet" href="css/styles.css">
	</head>
	<body>
    <div class="header-div">
      Documentation for
      <a href="https://github.com/cotarr/irc-hybrid-client">irc-hybrid-client</a>
    </div>
    <div class="menu-div-fixed">
      <div class="menu-div">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="installation.html">Installation</a></li>
          <li><a href="login-config.html">Login Config</a></li>
          <li><a class="active" href="server-config.html">IRC Config</a></li>
          <li><a href="text-commands.html">Text Commands</a></li>
          <li><a href="faq.html">FAQ</a></li>
          <li><a href="coding.html">Coding Notes</a></li>
          <li><a href="api.html">API Examples</a></li>
          <li><a href="history.html">Change Log</a></li>
          <li><a href="license.html">License</a></li>
        </ul>
      </div>
    </div> <!-- /menu-div-fixed -->

    <div class="outer-div">
      <div class="text-div">
        <div class="desc-title">
          IRC Configuration
        </div>

        <div class="install-section-title">Copy example configuration</div>
        <p>
          The git repository includes an example configuration file
          named &quotexample-servers.json&quot. The first step
          is to make a copy of this file to &quotservers.json&quot.
          If you are on a multi user system you may optionally
          change permissions.
        </p>

<div class="pre-div"><pre>
  cp -v example-servers.json servers.json
  chmod 600 servers.json
</pre></div>

        <div class="install-section-title">Previous IRC Experience</div>
        <p>
          For purposes of this help file, it is assumed the person installing this
          IRC client is familiar with standard IRC server connection parameters, including
          hostname or IP address, port number, TLS flag, IRC nickname, IRC user, and real name.
          If you are not familiar with these concepts, it is recommended to consult
          some general IRC help web pages.
        </p>
        <div class="install-section-title">No Remote Config</div>
        <p>
          In this program, the list of IRC servers must be configured in this configuration file
          using a standard text editor such as nano. The list of servers is
          read when the server is started. If the list is updated, the server must be
          restarted to read the new list.
        </p>
        <p>
          At this time, there is no provision to edit the IRC server list remotely from the web page.
          Considering this was primarily concieved to be a smartphone IRC client, complex
          HTML forms presence certain challenges on a smartphone.
          There was no reason to unnecessarily increase security risk by adding
          an API capable of writing server configuration. Should someone
          gain unauthorized access, such as a forged cookie or cross-site script, it would
          not be possible to remotely modify any of the server configuration.
        </p>

        <div class="install-section-title">JSON Format</div>
        <p>
          A brief note about syntax. The servers.json file represents a JSON structured data object.
          JSON syntax must be exact.
          The servers.json file includes a &quotserverArray&quot property.
          The square brackets [ ] define a javascript array.
        </p>
<pre><yellow-example>
  "serverArray": [
  ]
</yellow-example></pre>
        <p>
          Each of the curley braces { } within the array is a javascript object
          with one object for each server definition.
          Note the server objects are separated by commas, except the last
        </p>
<pre><yellow-example>
  "serverArray": [
    {
      ...the first server...
    },
    {
      ...the second server...
    },
    {
      ...the third server...
    }
  ]
</yellow-example></pre>

        <h2>Server Configuration (each IRC server)</h2>

        <div class="install-section-title">1 - IRC Server configuration</div>
        <p>
          There are 6 properties to define a server entry.
          The &quotname&quot property can be set to any value.
          It is used to display the name of your selection.
          If you are using a phone, keep &quotname&quot short.
        </p>
        <p>
          At this time there are no provisions to configure a server to
          auto-connect to IRC on startup.
          There is no provision to auto-join channels on startup.
        </p>
        <p>
          In this example, an IRC server is configured without TLS encryption.
        </p>
<div class="pre-div"><pre>
  "name": "DALnet",
  "host": "lion.dal.net",
  "port": 6667,
  "tls": false,
  "verify": false,
  "password": "",
</pre></div>
<p>
  To configure for TLS encryption the &quotport&quot was changed to 6697 and
  &quottls&quot was set to true. If the IRC server hostname should be
  verified, set &quotverify&quot to true. For number IP addresses,
  set &quotverify&quot to false.
</p>

<div class="pre-div"><pre>
  "name": "DALnet",
  "host": "lion.dal.net",
  "port": 6697,
  "tls": true,
  "verify": true,
  "password": "",
</pre></div>
        <div class="install-section-title">2 - NickServ IDENTIFY</div>
        <p>
          There is a provision to automatically dispatch a NickServ
          IDENTIFY message when the IRC server connection is made and
          when the current IRC nickname matches the property &quotidentifyNick&quot.
        </p>
        <p>
          To disable this feature, set the following properties
          to be zero length strings.
        </p>
<div class="pre-div"><pre>
  "identifyNick": "",
  "identifyCommand": "",
</pre></div>
      <p>
        Please read this section carefully. This &quotidentifyCommand&quot property
        represents a <yellow-example>raw IRC command, not a private message</yellow-example>.
        This allows identification with IRC servers where
        &quotNICKSERV&quot and &quotNS&quot are valid IRC server commands and
        understood by NickServ network services.
        IN cases where the identification must be sent by private message (/msg), then
        the proper private message raw command must be constructed with valid syntax.
      </p>
      <p>
        If NickServ services requires a simple private message then the PRIVMSG
        raw server command would be used. The format of the entire message starts
        with the command &quotPRIVMSG&quot, followed by a space, followed by
        the IRC nickname of the recipient, followed by a space. The the
        message delimiter is a colon character &quot:&quot which is then followed
        with the private message contents. To identify in this manner using
        the password xxxxxxxx to identify your nickname MyNickname,
        the configuration would be set as shown in the next example.
        Note the colon character prefixing :IDENTIFY

      </p>
<div class="pre-div"><pre>
  "identifyNick": "MyNickname",
  "identifyCommand": "PRIVMSG NickServ :IDENTIFY xxxxxxxx",
</pre></div>
      <p>
        In the case where services have non-spoofable nicknames, the recipient
        of the private message would be modified as shown in the next example.
        Note the colon character prefixing :IDENTIFY
      </p>
<div class="pre-div"><pre>
  "identifyNick": "MyNickname",
  "identifyCommand": "PRIVMSG NickServ@services.dal.net :IDENTIFY xxxxxxxx",
</pre></div>
      <p>
        In the case where an IRC network has reserved &quotNICKSERV&quot as
        a custom IRC command you can use the next method. It reduces the
        risk of sending your IDENTIFY password to another user pretending
        to be Nickserv. In this case, IDENTIFY and the password are sent as
        command parameters, so the colon is not required.
      </p>
<div class="pre-div"><pre>
  "identifyNick": "MyNickname",
  "identifyCommand": "NICKSERV IDENTIFY xxxxxxxx",
</pre></div>


<div class="install-section-title">3 - IRC User Information</div>
      <p>
        This section should be obvious to anyone using IRC.
      </p>
      <p>
        Please note that different type of IRC servers have different
        requirements for the number of characters allowed in a Nickname,
        user or real name. These are often displayed in a server message
        when you first connect to IRC. At the present time, the maximum
        length of these values is not checked by this program, so exceeding the limit
        set by the server would generate an IRC server error.
      </p>
<div class="pre-div"><pre>
  "nick": "MyNickname",
  "user": "user",
  "real": "John Doe",
  "modes": "+i",
</pre></div>
<div class="install-section-title">4 - Favorite channels</div>
      <p>
        At this time, the program does not auto-join of IRC #channels on startup.
        This may be added in the future.
      </p>
      <p>
        The &quotchannelList&quot property is used to designate a javascript array
        of string entries, where each array value is the name of an IRC channel.
        After connection to an IRC server, the favorite channels are
        displayed as buttons to allow easy /JOIN capability when using a
        smartphone.
        The array may be empty, but it must exist.
      </p>
      <p>
        If the IRC server auto-reconnect is enabled as discussed below, then upon
        a successful re-connect to the irc server, up to 5 irc channels
        will be automatically rejoined.
      </p>

<div class="pre-div"><pre>
  "channelList": ["#myChannel", "#otherChannel"],
</pre></div>

<h2>Global Configuration</h2>

<div class="install-section-title">Raw Message Log (global)</div>
      <p>
        There is a global flag to enable logging IRC messages to
        the &quotlogs/irc.log&quot file located with the backend web server.
        There are no provisions for logging on the local machine where
        the web browser is open.
        All messages from the IRC server are logged in raw message format.
        The program does not include log file pruning,
        so please watch the size of your log files as they can become quite large.
        This is really intended for debugging. It is recommended to leave
        this set to false.
      </p>

      <div class="install-section-title">CTCP Time Locale (global)</div>
        <p>
          The &quotctcpTimeLocale&quot property is optional. It may be used
          to specify a CTCP TIME reply format.
          It may be used in the case where a client time zone when different
          from the server.
          This is used by native JavaScript toLocaleString() function.
          Caution, the toLocaleString() is implementation dependant, and
          this was written using Debian 10.
          The value is an array. The first element is the toLocaleString() locales string.
          The default locales string is &quoten.US&quot. The second element
          is used by the timeZone property of toLocaleString options parameter. The
          default value is &quotUTC&QUOT. It may be set to a different
          locale value such as "America/Chicago".
        </p>

      <div class="install-section-title">Auto Re-Connect (Global)</div>
      <p>
        There is a global flag &quotircAutoReconnect&quot.
        If this flag is set to true, the backend web server will
        attempt to reconnect to the IRC server after it has been disconnected.
        It will attempt to re-join up to 5 channels at the time of disconnection.
        Each time the IRC server connects, a new message cache is started,
        so previous messages will not show. This feature does not support
        channel passwords.
      </p>

      <div class="install-section-title">configVersion (Global)</div>
      <p>
        The property &quotconfigVersion&quot is intended for future use.
        It provides a method to issue a startup message when attempting
        to use a configuration   file that may be impacted by breaking changes.
        It will remain at 1 until there is a breaking change.
      </p>

      <h2>Example server.json</h2>
      <p>
        The server.json file should look something like this.
      </p>

<div class="pre-div"><pre>
{
  "configVersion": 1,
  "ircAutoReconnect": true,
  "ctcpTimeLocale": ["en-US", "UTC"],
  "rawMessageLog": false,
  "serverArray": [
    {
      "name": "DALnet",
      "host": "lion.dal.net",
      "port": 6697,
      "tls": true,
      "verify": true,
      "password": "",
      "identifyNick": "MyNickname",
      "identifyCommand": "PRIVMSG NickServ@services.dal.net :IDENTIFY xxxxxxxx",
      "nick": "MyNickname",
      "user": "user",
      "real": "John Doe",
      "modes": "+i",
      "channelList": ["#myChannel", "#otherChannel"]
    }
  ]
}
</pre></div>
<p>
  The property &quotconfigVersion&quot is intended for future use.
  It provides a method to issue a startup message when attempting
  to use a configuration   file that may be impacted by breaking changes.
  It will remain at 1 until there is a breaking change.
</p>

      </div> <!-- /text-div -->

    </div> <!-- outer-div -->

    <div class="footer-div">
      Repository:
      <a href="https://github.com/cotarr/irc-hybrid-client">
        https://github.com/cotarr/irc-hybrid-client</a>
    </div> <!-- /footer-div -->
	</body>
</html>
